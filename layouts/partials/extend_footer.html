{{- /* Footer custom content area start */ -}}
<script>
(function() {
    var menu = document.getElementById('menu');
    if (!menu) return;

    var active = menu.querySelector('.active');
    if (!active) return;

    var indicator = document.createElement('div');
    indicator.id = 'menu-indicator';
    menu.appendChild(indicator);

    var menuRect = menu.getBoundingClientRect();
    var activeRect = active.getBoundingClientRect();
    var currentLeft = activeRect.left - menuRect.left + menu.scrollLeft;
    var currentWidth = activeRect.width;

    var prev = sessionStorage.getItem('tab-indicator');
    if (prev) {
        prev = JSON.parse(prev);
        indicator.style.transition = 'none';
        indicator.style.left = prev.left + 'px';
        indicator.style.width = prev.width + 'px';
        indicator.offsetHeight; // force reflow
        indicator.style.transition = '';
        indicator.style.left = currentLeft + 'px';
        indicator.style.width = currentWidth + 'px';
    } else {
        indicator.style.left = currentLeft + 'px';
        indicator.style.width = currentWidth + 'px';
    }

    sessionStorage.setItem('tab-indicator', JSON.stringify({ left: currentLeft, width: currentWidth }));
})();
</script>

<script>
(function() {
    var entries = document.querySelectorAll('.post-entry, .first-entry');
    for (var i = 0; i < entries.length; i++) {
        entries[i].style.animationDelay = (i * 0.06) + 's';
        entries[i].classList.add('animate-in');
    }
})();
</script>

{{- if (and (eq .Kind "page") (ne .Layout "archives") (ne .Layout "search")) }}
<script>
(function() {
    var bar = document.createElement('div');
    bar.id = 'reading-progress';
    document.body.appendChild(bar);

    window.addEventListener('scroll', function() {
        var scrollTop = window.scrollY;
        var docHeight = document.documentElement.scrollHeight - window.innerHeight;
        if (docHeight > 0) {
            bar.style.width = (scrollTop / docHeight * 100) + '%';
        }
    }, { passive: true });
})();
</script>
{{- end }}
{{- /* Footer custom content area end */ -}}
